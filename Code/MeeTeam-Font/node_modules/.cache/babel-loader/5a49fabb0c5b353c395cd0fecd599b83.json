{"ast":null,"code":"import global_msg from '../utils/global.js';\nimport { creatlist } from '@/api/creatlist.js';\nexport default {\n  name: 'CreatList',\n\n  data() {\n    return {\n      detailshow: false,\n      props: {\n        multiple: true\n      },\n      //级联选择器确定选项选不选择\n      options: [{\n        disabled: false,\n        value: 1,\n        label: '竞赛组队',\n        children: [{\n          value: 2,\n          label: '创新创业'\n        }, {\n          value: 3,\n          label: '数学建模'\n        }, {\n          value: 4,\n          label: '学科竞赛'\n        }, {\n          value: 5,\n          label: '其他竞赛'\n        }]\n      }, {\n        disabled: false,\n        value: 6,\n        label: '项目课程组队',\n        children: [{\n          value: 7,\n          label: '新生院'\n        }, {\n          value: 8,\n          label: '建筑与城市规划学院'\n        }, {\n          value: 9,\n          label: '土木工程学院'\n        }, {\n          value: 10,\n          label: '机械与能源工程学院'\n        }, {\n          value: 11,\n          label: '经济与管理学院'\n        }, {\n          value: 12,\n          label: '环境科学与工程学院'\n        }, {\n          value: 13,\n          label: '材料科学与工程学院'\n        }, {\n          value: 14,\n          label: '电子与信息工程学院'\n        }, {\n          value: 15,\n          label: '人文学院'\n        }, {\n          value: 16,\n          label: '汽车学院'\n        }, {\n          value: 17,\n          label: '软件学院'\n        }, {\n          value: 18,\n          label: '其他学院'\n        }]\n      }],\n      checkList: [],\n      ruleForm: {\n        require_id: '',\n        purpose: '',\n        team_type: '',\n        team_limit: '',\n        details: '',\n        require_status: '',\n        originator_id: '',\n        project_id: '',\n        region: [],\n        //地区得到的是一个数组\n        team_type_detail: [],\n        //具体的类型得到的也是一个数组\n        requirement_name: ''\n      },\n      rules: {\n        purpose: [{\n          required: true,\n          message: '请输入组队目的',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 80,\n          message: '长度在 3-80 个字符以内',\n          trigger: 'blur'\n        }],\n        team_type: [{\n          required: true,\n          message: '请选择组队类型',\n          trigger: 'change'\n        }],\n        details: [{\n          required: true,\n          message: '请填写需求细则',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 100,\n          message: '长度在 3-100 个字符以内',\n          trigger: 'blur'\n        }],\n        team_limit: [{\n          required: true,\n          message: '请选择组队人数',\n          trigger: 'change'\n        }],\n        region: [{\n          type: 'array',\n          required: true,\n          message: '请至少选择一个校区',\n          trigger: 'change'\n        }],\n        requirement_name: [{\n          required: true,\n          message: '请输入需求名称',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 80,\n          message: '长度在 3-80 个字符以内',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    submitForm(formName) {\n      console.log(this.ruleForm.team_type_detail); // console.log(this.ruleForm.team_type_detail);\n\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          console.log('submit!');\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n      global_msg.requirenum += 1; //全局需求个数+1\n\n      global_msg.projectnum += 1; //全局项目个数+1\n\n      this.ruleForm.project_id = global_msg.projectnum; //得到全局项目个数\n\n      this.ruleForm.require_id = global_msg.requirenum; //得到全局需求个数\n\n      this.ruleForm.originator_id = global_msg.nowuserid; //得到全局userid\n\n      this.ruleForm.require_status = '0/' + this.ruleForm.team_limit; //改成了0/人数\n\n      var RegionLast = this.ruleForm.region.join(','); // 把数组项拼接成字符串，以逗号,分隔;转换后的地区，需要转成字符串\n\n      var TeamDetailLast = this.ruleForm.team_type_detail.join('-');\n      var reg = new RegExp(\"1,\", \"g\");\n      TeamDetailLast = TeamDetailLast.replace(reg, \"\"); //把父结点的值去掉\n\n      reg = new RegExp(\"6,\", \"g\");\n      TeamDetailLast = TeamDetailLast.replace(reg, \"\"); //把父结点的值去掉\n      // alert(this.ruleForm.require_id)\n      //  alert(this.ruleForm.purpose)\n      //  alert(this.ruleForm.team_type)\n      //  alert(this.ruleForm.team_limit)\n      //  alert(this.ruleForm.details)\n      // alert(this.ruleForm.require_status)\n      // alert(this.ruleForm.originator_id)\n      // alert(this.ruleForm.project_id)\n      // alert(this.ruleForm.project_id)\n      // alert(RegionLast)\n      // alert(this.ruleForm.project_id)\n      // alert(TeamDetailLast);\n\n      let vm = this; //请求地址,this和vm指的是全局\n\n      let param = {\n        require_id: this.ruleForm.require_id,\n        purpose: this.ruleForm.purpose,\n        team_type: this.ruleForm.team_type,\n        team_limit: this.ruleForm.team_limit,\n        details: this.ruleForm.details,\n        require_status: this.ruleForm.require_status,\n        originator_id: this.ruleForm.originator_id,\n        project_id: this.ruleForm.project_id,\n        region: RegionLast,\n        team_type_detail: TeamDetailLast,\n        requirement_name: this.ruleForm.requirement_name\n      };\n      creatlist(param).then(function (res) {\n        if (res.data === false) {\n          vm.$message.error(\"提交失败\");\n          vm.resetForm(formName);\n        } else {\n          vm.$message.success(\"提交成功\");\n          vm.$router.push({\n            path: \"/users/InforList\"\n          }); //接下来进入到哪个路由\n        }\n      });\n    },\n\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n      this.ruleForm.team_type_detail = \"\";\n      this.detailshow = false;\n    },\n\n    teamtypecheck() {\n      this.options[0].disabled = false;\n      this.options[1].disabled = false;\n      this.detailshow = true;\n      if (this.ruleForm.team_type === \"竞赛\") this.options[1].disabled = true;else if (this.ruleForm.team_type === \"课程项目\") this.options[0].disabled = true;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAgDA;AACA;AACA;EACAA,iBADA;;EAEAC;IACA;MACAC,iBADA;MAEAC;QAAAC;MAAA,CAFA;MAEA;MACAC,UACA;QACAC,eADA;QAEAC,QAFA;QAGAC,aAHA;QAIAC,WACA;UAAAF;UAAAC;QAAA,CADA,EAEA;UAAAD;UAAAC;QAAA,CAFA,EAGA;UAAAD;UAAAC;QAAA,CAHA,EAIA;UAAAD;UAAAC;QAAA,CAJA;MAJA,CADA,EAYA;QACAF,eADA;QAEAC,QAFA;QAGAC,eAHA;QAIAC,WACA;UAAAF;UAAAC;QAAA,CADA,EAEA;UAAAD;UAAAC;QAAA,CAFA,EAGA;UAAAD;UAAAC;QAAA,CAHA,EAIA;UAAAD;UAAAC;QAAA,CAJA,EAKA;UAAAD;UAAAC;QAAA,CALA,EAMA;UAAAD;UAAAC;QAAA,CANA,EAOA;UAAAD;UAAAC;QAAA,CAPA,EAQA;UAAAD;UAAAC;QAAA,CARA,EASA;UAAAD;UAAAC;QAAA,CATA,EAUA;UAAAD;UAAAC;QAAA,CAVA,EAWA;UAAAD;UAAAC;QAAA,CAXA,EAYA;UAAAD;UAAAC;QAAA,CAZA;MAJA,CAZA,CAHA;MAmCAE,aAnCA;MAoCAC;QACAC,cADA;QAEAC,WAFA;QAGAC,aAHA;QAIAC,cAJA;QAKAC,WALA;QAMAC,kBANA;QAOAC,iBAPA;QAQAC,cARA;QASAC,UATA;QASA;QACAC,oBAVA;QAUA;QACAC;MAXA,CApCA;MAiDAC;QACAV,UACA;UAAAW;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA,CADA;QAKAZ,YACA;UAAAU;UAAAC;UAAAC;QAAA,CADA,CALA;QAQAV,UACA;UAAAQ;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA,CARA;QAYAX,aACA;UAAAS;UAAAC;UAAAC;QAAA,CADA,CAZA;QAeAN,SACA;UAAAS;UAAAL;UAAAC;UAAAC;QAAA,CADA,CAfA;QAkBAJ,mBACA;UAAAE;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA;MAlBA;IAjDA;EAyEA,CA5EA;;EA6EAI;IACAC;MACAC,4CADA,CAEA;;MACA;QACA;UACAA;QACA,CAFA,MAEA;UACAA;UACA;QACA;MACA,CAPA;MAQAC,2BAXA,CAWA;;MACAA,2BAZA,CAYA;;MACA,iDAbA,CAaA;;MACA,iDAdA,CAcA;;MACA,mDAfA,CAeA;;MACA,+DAhBA,CAgBA;;MACA,gDAjBA,CAiBA;;MACA;MACA;MACAC,iDApBA,CAoBA;;MACAC;MACAD,iDAtBA,CAsBA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA,cAnCA,CAoCA;;MACA;QACAtB,oCADA;QAEAC,8BAFA;QAGAC,kCAHA;QAIAC,oCAJA;QAKAC,8BALA;QAMAC,4CANA;QAOAC,0CAPA;QAQAC,oCARA;QASAC,kBATA;QAUAC,gCAVA;QAWAC;MAXA;MAaAc;QACA;UACAC;UACAA;QACA,CAHA,MAGA;UACAA;UACAA;YAAAC;UAAA,GAFA,CAEA;QACA;MACA,CARA;IASA,CA5DA;;IA6DAC;MACA;MACA;MACA;IACA,CAjEA;;IAkEAC;MACA;MACA;MACA;MACA,sCACA,gCADA,KAEA,wCACA;IACA;;EA1EA;AA7EA","names":["name","data","detailshow","props","multiple","options","disabled","value","label","children","checkList","ruleForm","require_id","purpose","team_type","team_limit","details","require_status","originator_id","project_id","region","team_type_detail","requirement_name","rules","required","message","trigger","min","max","type","methods","submitForm","console","global_msg","TeamDetailLast","reg","creatlist","vm","path","resetForm","teamtypecheck"],"sourceRoot":"src/view","sources":["CreatList.vue"],"sourcesContent":["<template>\r\n  <div id=\"home\">\r\n    <!--页头-->\r\n    <el-header>发布组队需求</el-header>\r\n    <el-main>\r\n      <el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n        <el-form-item label=\"需求名称\" prop=\"requirement_name\">\r\n          <el-input v-model=\"ruleForm.requirement_name\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"组队目的\" prop=\"purpose\">\r\n          <el-input v-model=\"ruleForm.purpose\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"组队类型\" prop=\"team_type\">\r\n          <el-select v-model=\"ruleForm.team_type\" placeholder=\"请选择组队类型\" @change=\"teamtypecheck\">\r\n            <el-option label=\"竞赛组队\" value=\"竞赛\"></el-option>\r\n            <el-option label=\"课程项目组队\" value=\"课程项目\"></el-option>\r\n          </el-select>\r\n          <el-cascader :options=\"options\" :props=\"props\" :show-all-levels=\"false\" clearable\r\n            v-model=\"ruleForm.team_type_detail\" v-show=\"detailshow\" placeholder=\"请选择组队具体情况\"></el-cascader>\r\n        </el-form-item>\r\n        <el-form-item label=\"组队人数\" prop=\"team_limit\">\r\n          <el-select v-model=\"ruleForm.team_limit\" placeholder=\"请选择组队人数\">\r\n            <el-option label=\"3\" value=\"3\"></el-option>\r\n            <el-option label=\"4\" value=\"4\"></el-option>\r\n            <el-option label=\"5\" value=\"5\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"组队校区\" prop=\"region\">\r\n          <el-checkbox-group v-model=\"ruleForm.region\" id=\"checkbox\">\r\n            <el-checkbox label=\"四平\" name=\"region\"></el-checkbox>\r\n            <el-checkbox label=\"嘉定\" name=\"region\"></el-checkbox>\r\n            <el-checkbox label=\"沪西\" name=\"region\"></el-checkbox>\r\n            <el-checkbox label=\"沪北\" name=\"region\"></el-checkbox>\r\n          </el-checkbox-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"需求细则\" prop=\"details\">\r\n          <el-input type=\"textarea\" v-model=\"ruleForm.details\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">立即创建</el-button>\r\n          <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-main>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport global_msg from '../utils/global.js'\r\nimport { creatlist } from '@/api/creatlist.js'\r\nexport default {\r\n  name: 'CreatList',\r\n  data() {\r\n    return {\r\n      detailshow: false,\r\n      props: { multiple: true },//级联选择器确定选项选不选择\r\n      options: [\r\n        {\r\n          disabled: false,\r\n          value: 1,\r\n          label: '竞赛组队',\r\n          children: [\r\n            { value: 2, label: '创新创业' },\r\n            { value: 3, label: '数学建模' },\r\n            { value: 4, label: '学科竞赛' },\r\n            { value: 5, label: '其他竞赛' },\r\n          ]\r\n        },\r\n        {\r\n          disabled: false,\r\n          value: 6,\r\n          label: '项目课程组队',\r\n          children: [\r\n            { value: 7, label: '新生院' },\r\n            { value: 8, label: '建筑与城市规划学院' },\r\n            { value: 9, label: '土木工程学院' },\r\n            { value: 10, label: '机械与能源工程学院' },\r\n            { value: 11, label: '经济与管理学院' },\r\n            { value: 12, label: '环境科学与工程学院' },\r\n            { value: 13, label: '材料科学与工程学院' },\r\n            { value: 14, label: '电子与信息工程学院' },\r\n            { value: 15, label: '人文学院' },\r\n            { value: 16, label: '汽车学院' },\r\n            { value: 17, label: '软件学院' },\r\n            { value: 18, label: '其他学院' },\r\n          ]\r\n        },\r\n      ],\r\n      checkList: [],\r\n      ruleForm: {\r\n        require_id: '',\r\n        purpose: '',\r\n        team_type: '',\r\n        team_limit: '',\r\n        details: '',\r\n        require_status: '',\r\n        originator_id: '',\r\n        project_id: '',\r\n        region: [], //地区得到的是一个数组\r\n        team_type_detail: [],//具体的类型得到的也是一个数组\r\n        requirement_name:''\r\n      },\r\n      rules: {\r\n        purpose: [\r\n          { required: true, message: '请输入组队目的', trigger: 'blur' },\r\n          { min: 3, max: 80, message: '长度在 3-80 个字符以内', trigger: 'blur' }\r\n        ],\r\n        team_type: [\r\n          { required: true, message: '请选择组队类型', trigger: 'change' }\r\n        ],\r\n        details: [\r\n          { required: true, message: '请填写需求细则', trigger: 'blur' },\r\n          { min: 3, max: 100, message: '长度在 3-100 个字符以内', trigger: 'blur' }\r\n        ],\r\n        team_limit: [\r\n          { required: true, message: '请选择组队人数', trigger: 'change' }\r\n        ],\r\n        region: [\r\n          { type: 'array', required: true, message: '请至少选择一个校区', trigger: 'change' }\r\n        ],\r\n        requirement_name:[\r\n           { required: true, message: '请输入需求名称', trigger: 'blur' },\r\n          { min: 3, max: 80, message: '长度在 3-80 个字符以内', trigger: 'blur' }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    submitForm(formName) {\r\n      console.log(this.ruleForm.team_type_detail);\r\n      // console.log(this.ruleForm.team_type_detail);\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          console.log('submit!');\r\n        } else {\r\n          console.log('error submit!!');\r\n          return false;\r\n        }\r\n      });\r\n      global_msg.requirenum += 1;//全局需求个数+1\r\n      global_msg.projectnum += 1;//全局项目个数+1\r\n      this.ruleForm.project_id = global_msg.projectnum;//得到全局项目个数\r\n      this.ruleForm.require_id = global_msg.requirenum;//得到全局需求个数\r\n      this.ruleForm.originator_id = global_msg.nowuserid;//得到全局userid\r\n      this.ruleForm.require_status = '0/' + this.ruleForm.team_limit;//改成了0/人数\r\n      var RegionLast = this.ruleForm.region.join(','); // 把数组项拼接成字符串，以逗号,分隔;转换后的地区，需要转成字符串\r\n      var TeamDetailLast = this.ruleForm.team_type_detail.join('-');\r\n      var reg = new RegExp(\"1,\", \"g\");\r\n      TeamDetailLast = TeamDetailLast.replace(reg, \"\");//把父结点的值去掉\r\n      reg = new RegExp(\"6,\", \"g\");\r\n      TeamDetailLast = TeamDetailLast.replace(reg, \"\");//把父结点的值去掉\r\n      // alert(this.ruleForm.require_id)\r\n      //  alert(this.ruleForm.purpose)\r\n      //  alert(this.ruleForm.team_type)\r\n      //  alert(this.ruleForm.team_limit)\r\n      //  alert(this.ruleForm.details)\r\n      // alert(this.ruleForm.require_status)\r\n      // alert(this.ruleForm.originator_id)\r\n      // alert(this.ruleForm.project_id)\r\n      // alert(this.ruleForm.project_id)\r\n      // alert(RegionLast)\r\n      // alert(this.ruleForm.project_id)\r\n      // alert(TeamDetailLast);\r\n      let vm = this;\r\n      //请求地址,this和vm指的是全局\r\n      let param = {\r\n        require_id: this.ruleForm.require_id,\r\n        purpose: this.ruleForm.purpose,\r\n        team_type: this.ruleForm.team_type,\r\n        team_limit: this.ruleForm.team_limit,\r\n        details: this.ruleForm.details,\r\n        require_status: this.ruleForm.require_status,\r\n        originator_id: this.ruleForm.originator_id,\r\n        project_id: this.ruleForm.project_id,\r\n        region: RegionLast,\r\n        team_type_detail: TeamDetailLast,\r\n        requirement_name: this.ruleForm.requirement_name\r\n      }\r\n      creatlist(param).then(function (res) {\r\n        if (res.data === false) {\r\n          vm.$message.error(\"提交失败\");\r\n          vm.resetForm(formName);\r\n        } else {\r\n          vm.$message.success(\"提交成功\");\r\n          vm.$router.push({ path: \"/users/InforList\" }); //接下来进入到哪个路由\r\n        }\r\n      })\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n      this.ruleForm.team_type_detail=\"\";\r\n      this.detailshow = false;\r\n    },\r\n    teamtypecheck() {\r\n      this.options[0].disabled = false;\r\n      this.options[1].disabled = false;\r\n      this.detailshow = true;\r\n      if (this.ruleForm.team_type === \"竞赛\")\r\n        this.options[1].disabled = true;\r\n      else if (this.ruleForm.team_type === \"课程项目\")\r\n        this.options[0].disabled = true;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-header,\r\n.el-footer {\r\n  font-weight:900;\r\n  font-size:24px;\r\n  background-color: #B3C0D1;\r\n  color: #333;\r\n  text-align: center;\r\n  line-height: 60px;\r\n}\r\n.el-main {\r\n  background-color: #ecf0f5;\r\n  color: #333;\r\n  text-align: left;\r\n  line-height: 220px;\r\n  height: 100%;\r\n}\r\n#home {\r\n  width: 100%;\r\n  min-height: 100vh;\r\n  background-color: #ecf0f5;\r\n  background-size: 100% 100%;\r\n}\r\n.demo-ruleForm >>> .el-form-item__label /*标题的字体大小 */\r\n{\r\n  font-size: 18px;\r\n}\r\n#checkbox >>> .el-checkbox__label /*复选框的字体大小 */\r\n{\r\n  font-size: 18px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}